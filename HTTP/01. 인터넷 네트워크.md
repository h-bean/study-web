## 인터넷 통신

- 서버와 클라이언트 사이에 복잡한 인터넷망이 존재
- 어떻게 복잡한 인터넷 망을 뚫고 서버와 클라이언트가 통신할까?


## IP (Internet Protocol)

- 통신을 위한 주소가 IP (EX. 100.100.100.1)
- IP의 역할?
  - 지정한 IP 주소에 데이터 전달
  - 패킷이라는 통신 단위로 데이터 전달
    - 출발/목적지 IP, 메시지 담아서 전달한다.
    - 목적지에 전달된 패킷.  
      -> 그 후 잘 받았다는 표시(OK)를 다시 출발지로 보내줌

- IP 프로토콜의 한계
  - 비연결성 : 패킷 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송 해버림
  - 비신뢰성 : 중간에 패킷이 사라짐. 순서대로 안 감.
  - 프로그램 구분 : 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이면?

- 대상이 서비스 불능 상태 -> 패킷 전송?  
  상태를 모르기 때문에 걍~ 보내버림

- 패킷 소실  
  인터넷 망의 중간 서버가 문제가 생긴다? 그냥... 그렇게 끝나버림

- 패킷 전달 순서 문제  
  크기가 큰 패킷이 있다면 끊어서 보냄  
  의도와 다르게 뒤 패킷이 먼저 도착한다면?  
  IP 프로토콜 만으로는 해결할 수 없음

--> 이런 문제들은 TCP 프로토콜을 이용해 해결할 수 있다!


# TCP, UDP
- UDP는 IP의 문제를 해결하진 않지만, 살~짝 도움 되는 부분이 있으니 알고가자.

- 인터넷 프로토콜 스택의 4계층  
  애플리케이션 계층 (HTTP, FTP) - 웹 브라우저, 게임, 채팅 프로그램등  
  전송 계층 (TCP, UDP) - OS  
  인터넷 계층 (IP) - OS  
  네트워크 인터페이스 계층 (LAN카드 등등..) - LAN드라이버, LAN장비 ----인터넷 ---> 컴퓨터(서버)

- 채팅 프로그램의 예
  - A서버가 "Hello" 전달 (SOCKET 라이브러리를 통해 OS계층에 넘김)
  - TCP가 "Hello"에 TCP 정보를 씌운다.
  - IP가 그 위에 IP 정보를 씌운다. (IP 패킷 생성)
  - LAN카드를 통해 인터넷으로 나감

- IP 패킷 : 출발지/목적지 IP , 기타 ...  
  TCP 세그먼트 : 출발지/목적지 PORT, 전송 제어, 순서, 검증 정보 ..  
  (IP의 문제를 해결!)

- TCP 특징
  전송 제어 프로토콜 (Transmission Control Protocol, 전송을 어떻게 할지 제어)
  - 연결 지향 : TPC 3 Way Handshake (가상 연결)  
    A -> B로 보낼 때 B가 무사한지, 정상인지 검증 후 보냄
  - 데이터 전달 보증  
    패킷 누락 시 알 수 있음
  - 순서 보장 (간략하게 뒤에서 볼 것)
  - 신뢰할 수 있는 프로토콜
  - 현재는 대부분 TCP 사용

- TPC 3 Way Handshake  
  ![3way handshake](https://user-images.githubusercontent.com/98109708/151746857-1d0390ff-d60d-489d-9627-097c159e529c.png)  
  클라이언트가 SYN 메시지 보냈는데, 서버 응답 없으면 데이터 전송 안함!  
  - 요즘은 최적화 되어서, 3.ACK 시 데이터도 함께 보냄

- 데이터 전달 보증  
  데이터 전달 후에 서버가 잘 받았다고 답장 해줌  
  답장이 없다면 문제 있구나~ 인지할 수 있음

- 순서 보장  
  TCP 세그먼트에 순서 정보가 있기 때문에 가능한것  
  ![패킷 순서 보장](https://user-images.githubusercontent.com/98109708/151747274-f245ec0e-848a-4953-9608-344b088eb3ef.png)


- UDP 특징
  - 기능 거의 없음
  - TCP의 기능 다 ! 없고, IP기능 + PORT 정보 정도만 추가 된 것
    - 프로그램 구분 문제 해결
  - 그럼 어디다 쓰지..?
    - TCP는 검증을 계속 하므로 속도가 느림
    - 몇몇 검증 과정을 빼고 작동하도록 UDP를 변경해서 사용할 수 있다. (최적화 필요한 경우)


# PORT

- 서버 안에서 돌아가는 애플리케이션의 목적지
- 같은 IP내의 프로그램 구분
- IP는 아파트, PORT는 동/호

- 포트 번호
  - 0~65535 : 할당 가능
  - 잘 알려진 PORT : 사용 비권장
    - FTP - 20, 21
    - TELNET - 23
    - HTTP - 80
    - HTTPS - 443


# DNS

- IP는 기억하기 어려움  
  IP는 변경될 수 있음

- DNS (Domain Name System) 서버
  - 도메인 명과 IP를 매핑해서 저장해 둠
  - 클라이언트는 DNS 서버에 도메인 명을 주고, IP를 알아냄  
    그 후 서버에 전송 ~


